# FriendlyELEC vendor U-Boot for NanoPi M6
#
# Uses pre-extracted binaries from FriendlyELEC Ubuntu image.
# Mainline U-Boot does NOT boot on NanoPi M6 (validated in Phase 2).
#
# Source: rk3588-sd-ubuntu-noble-minimal-6.1-arm64-20251222.img
name: u-boot-nanopi-m6
variant: scratch
shell: /toolchain/bin/bash
dependencies:
  - stage: base
steps:
  - install:
      - |
        mkdir -p /rootfs/artifacts/arm64/u-boot/nanopi-m6

        # Copy pre-extracted vendor binaries
        # /pkg is the context from artifacts/u-boot/nanopi-m6, vendor/ is a subdirectory
        cp -v /pkg/vendor/idbloader.img /rootfs/artifacts/arm64/u-boot/nanopi-m6/
        cp -v /pkg/vendor/uboot.img /rootfs/artifacts/arm64/u-boot/nanopi-m6/

        echo "Installed vendor U-Boot:"
        ls -la /rootfs/artifacts/arm64/u-boot/nanopi-m6/
finalize:
  - from: /rootfs
    to: /rootfs
